---
- name: Install gpsd
  package:
    name: 'gpsd'
    state: 'present'
  become: true
  register: res
  until: res is success
  retries: '{{ package_retries }}'
  delay: '{{ package_delay }}'
- name: Install gpsd clients
  package:
    name: 'gpsd-clients'
    state: 'present'
  become: true
  register: res
  until: res is success
  retries: '{{ package_retries }}'
  delay: '{{ package_delay }}'
- name: Start/stop gpsd service
  service:
    name: 'gpsd'
    enabled: '{{ gpsd_enabled | default(false) }}'
    state: '{{ "started" if gpsd_enabled | default(false) else "stopped" }}'
  become: true
  tags:
    - gpsd_config
